@echo off
::: __Seed builder__
:: AUTO_GENERATED
:: Add custom commands at the end

echo == Configuring docker .env
set /A REACTJS_PORT=3003
set IS_PROD=false

IF NOT "%~1" == "" set /A REACTJS_PORT=%1
IF NOT "%~2" == "" set IS_PROD=%2

echo "== Creating docker .envs"
del .\.env
echo # DOCKER SETTINGS > .\.env
echo ### MODIFY WITH WITH $ bin/setup.bat REACTJS_PORT IS_PROD ### >> .\.env
echo.>> .\.env
echo COMPOSE_PROJECT_NAME=reactjs_reference_frontend>> .\.env
echo COMPOSE_REACTJS_PORT=%REACTJS_PORT%>> .\.env
echo REACT_APP_IS_PROD=%IS_PROD%>> .\.env
echo PORT=%REACTJS_PORT%>> .\.env

echo == Deleting previous containers
docker compose down

echo == Building project
docker compose build

echo == Starting services
docker compose up -d

echo == Installing local dependencies
call npm install --legacy-peer-deps

echo == Cleaning services
docker compose stop

echo.
echo == Setup completed (Start server with bin/start.bat)
echo.

::  __End autogenerated__
::  Include commands after this block
:::